name: Build Python packages

on:
  release:
    types: [published]
  workflow_dispatch:

jobs:
    build:
      strategy:
        matrix:
          python_version: ["3.7", "3.8", "3.9", "3.10"]
      name: Build Python WHL package
      runs-on: ubuntu-18.04
      steps:
        - uses: actions/checkout@master
        - name: Initialize Python ${{matrix.python_version}}
          uses: actions/setup-python@v1
          with:
            python-version: ${{ matrix.python_version }}
        - name: Install dependencies and build
          run: |
              python -m pip install --upgrade pip 
              python -m pip install --upgrade build         
              python -m build
        - name: Upload binaries to release
          uses: svenstaro/upload-release-action@v2
          with:
            repo_token: ${{ secrets.GITHUB_TOKEN }}
            file: "dist/*.whl"
            tag: ${{ github.ref }}
            overwrite: true
            file_glob: true